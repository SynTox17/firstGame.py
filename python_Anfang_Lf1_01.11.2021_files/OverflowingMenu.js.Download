function OverflowingMenu(){function B(a){var f=$("#"+k).addClass(c.settings.cssClasses.moreMenu),e=0;a.each(function(a,b){a=$(b);b=a.outerWidth(!0);f.append(a);n(a,!1);a.is(t)||b>e&&(e=b)});a=b.offset().left;p.innerWidth()-a<=e&&(a=a+l-e);f.css("left",a+"px")}function u(){l=b.outerWidth(!0);var a=0<g.width()-q;q=g.width();a&&($("#"+k).children().each(function(a,f){$(f).insertBefore(b);n($(f),!1)}),b.hide());var f=Number.POSITIVE_INFINITY,e=g.width()-10,c=l;h.each(function(a,b){var d=$(b);n($(b),!0);
b=0;d.hasClass("moremenu-only")||(b=d.outerWidth(!0));if(a>=m||c+b>e||a<h.length-1&&c+b+l>e)return f=a,!1;c+=b});0<h.length-f&&window.innerWidth>v&&(b.css({display:"inline-block"}),B(h.filter(":gt("+(f-1)+")")))}function n(a,b){if(a.hasClass("l-menu-course")||a.hasClass("l-menu-project"))a.hasClass("moremenu-only")?b?a.hide():a.show():b?a.show():a.hide()}function w(){r&&clearTimeout(r);r=setTimeout(u,x)}function y(a){var b=$("#"+k),c=$(this.parentElement).children().first();if(a.keyCode===CommonConstants.keyCodes.tab){var g=
a.target.parentElement,h=g.parentElement;if(null==g.nextElementSibling||g.nextElementSibling.classList.contains("viewas-menu-header")||a.shiftKey)a.shiftKey?$(h).find("a:visible").first().is(":focus")&&($(h).find("a:visible").last().focus(),a.preventDefault()):($(h).find("a:visible").first().focus(),a.preventDefault())}a.keyCode===CommonConstants.keyCodes.escape&&(b.hide(),c.attr("aria-expanded",!1),b.off(d+" keydown",y),c.focus());a.type!==d&&a.which!==CommonConstants.keyCodes.enter||setTimeout(function(){b.hide();
c.attr("aria-expanded",!1)},0);a.stopPropagation()}function z(a){if(a.type===d||a.which===CommonConstants.keyCodes.enter){var c=$("#"+k),e=b.first("> .l-main-menu-lnk");"false"===$(".c-messages-popup").attr("aria-hidden")&&$(".c-messages__overlay").click();c.toggle();c.is(":visible")?(e.children().first().attr("aria-expanded",!0),c.find("a").first().focus(),c.on("keydown "+d,y),a.preventDefault()):e.children().first().attr("aria-expanded",!1)}}function A(a){var c=$("#"+k),d=$(this.parentElement).children().first();
c.is(":visible")&&(a=$(a.target),b.find("> .l-main-menu-lnk").is(a)||b.find("> .l-main-menu-lnk").children().is(a)||(c.hide(),d.attr("aria-expanded",!1)))}var c=this,p=$(window),g,h,b,l,k,t,d,r,x,m,q,v;c.initialize=function(){d="click";x=c.settings.windowResizeTimeoutInMilliseconds;g=c.controls.mainMenu;h=c.controls.mainMenuItems;b=c.controls.moreButton;k=c.settings.moreMenuId;t=c.settings.moreMenuItemsIgnoreClass||"";m=c.settings.maxNumberOfMainMenuItems;v=c.settings.minScreenWidth||0;q=g.width();
"undefined"==typeof m&&(m=Number.POSITIVE_INFINITY);b.append('<ul id="'+k+'" style="display:none;position:absolute;"></ul>');b.hide();u();p.resize(w);b.first("> .l-main-menu-lnk").on(d+" keydown",z);$(document).on(d+" "+CommonTriggers.clickInInnerFrame,A)};c.uninitialize=function(){p.off("resize",w);b.first("> .l-main-menu-lnk").off(d+" keydown",z);$(document).off(d+" "+CommonTriggers.clickInInnerFrame,A)};return c};
